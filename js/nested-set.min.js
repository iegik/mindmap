(()=>{var f=class{constructor(){this.setItem=(t,e)=>(this.Data[t]=e,this.Data[t]);this.getItem=t=>this.Data[t];this.removeItem=t=>{if(this.Data[t]!==void 0){for(var e=0;e<this.Structure.length;e++)this.Structure[e].itemId===t&&this.removeNode(this.Structure[e]._id);return delete this.Data[t],!0}else return!1};this.addRoot=t=>(this.Data[t]!==void 0&&(this.removeNodes(),this.Structure.push({_id:1,lkey:1,rkey:2,depth:1,childs:0,parentId:0,itemId:t})),this.Structure[0]._id);this.getRoot=()=>this.getNodes()[0];this.getMaxId=()=>this.Structure.reduce((t,{_id:e})=>t>e?t:e,-1/0);this.addNode=(t,e)=>{if(this.Data[e]!==void 0){var r=this.getNode(t,!0);if(!r)return!1;var i=this.getMaxId();return this.Structure=this.Structure.map(u=>(u.lkey>r.rkey&&(u.lkey+=2,u.rkey+=2),u.rkey>=r.rkey&&u.lkey<r.rkey&&(u.rkey+=2,u.childs++),u)),this.Structure.push({_id:i+1,lkey:r.rkey,rkey:r.rkey+1,depth:r.depth+1,childs:0,parentId:r._id,itemId:e}),i+1}};this.getNode=(t,e)=>{var r=this.Structure.filter(i=>i._id===t);return Array.isArray(r)&&r.length===1?e===!0?{...r[0]}:r[0]:!1};this.removeNode=t=>{var e=this.getNode(t,!0),r=this.getChilds(t).length+1;return e?(this.Structure=this.getNodes().map(i=>(i.rkey>e.rkey&&i.lkey<e.lkey&&(i.childs=i.childs-r),i)).filter(i=>!(i.lkey>=e.lkey&&i.rkey<=e.rkey)).map(i=>(i.rkey>e.rkey&&(i.lkey=i.lkey>e.lkey?i.lkey-(e.rkey-e.lkey+1):i.lkey,i.rkey=i.rkey-(e.rkey-e.lkey+1)),i)),this.Structure):!1};this.moveNode=(t,e)=>{var r=this.getNode(t,!0),i=this.getNode(e,!0),u=r.depth,l=r.rkey,h=r.lkey,c=i.depth,d=i.rkey-1,k=c-u+1,a=l-h+1,y;d>l?(y=d-h+1-a,this.Structure=this.Structure.map(s=>(s.lkey<=d&&s.rkey>h&&(s.rkey<=l?s.lkey=s.lkey+y:s.lkey>l&&(s.lkey=s.lkey-a),s.rkey<=l&&(s.depth=s.depth+k),s.rkey<=l?s.rkey=s.rkey+y:s.rkey<=d&&(s.rkey=s.rkey-a)),s))):(y=d-h+1,this.Structure=this.Structure.map(s=>(s.rkey>d&&s.lkey<l&&(s.lkey>=h?s.rkey=s.rkey+y:s.rkey<h&&(s.rkey=s.rkey+a),s.lkey>=h&&(s.depth=s.depth+k),s.lkey>=h?s.lkey=s.lkey+y:s.lkey>d&&(s.lkey=s.lkey+a)),s)))};this.getNodes=()=>this.Structure.sort((t,e)=>t.lkey-e.lkey);this.removeNodes=()=>{this.Structure=[]};this.getParent=t=>{var e=this.getParents(t);return e[e.length-1]===void 0?!1:e[e.length-1]};this.getParents=t=>{var e=this.getNode(t,!0);return e?this.getNodes().filter(r=>r.lkey<e.lkey&&r.rkey>e.rkey).map(r=>(r.data=this.Data[r.itemId],r)):[]};this.getChilds=(t,e)=>{var r=this.getNode(t,!0);return r?this.getNodes().filter(i=>i.lkey>=r.lkey&&i.rkey<=r.rkey&&t!==i._id&&(e===void 0?!0:i.depth<=r.depth+e)).map(i=>(i.data=this.Data[i.itemId],i)):[]};this.getBranch=t=>{var e=this.getNode(t);return e?this.getNodes().filter(r=>r.rkey>e.lkey&&r.lkey<e.rkey).map(r=>(r.data=this.Data[r.itemId],r)):[]};this.getTree=()=>this.getNodes().map(t=>(t.data=this.Data[t.itemId],t));this.clearAll=()=>{this.Structure=[],this.Data={}};this.isRoot=t=>{var e=this.getNode(t);return e&&e.parentId===0};this.isBranch=t=>{var e=this.getNode(t);return e&&e.childs>0};this.isLeaf=t=>{var e=this.getNode(t);return e&&e.childs===0};this.getMaxRightKey=()=>this.Structure.reduce((t,{rkey:e})=>t>e?t:e,-1/0);this.getMaxLeftKey=()=>this.Structure.reduce((t,{lkey:e})=>t>e?t:e,-1/0);this.getCountNodes=()=>this.Structure.length;this.checkTree=()=>{var t=this.Structure.filter(u=>u.lkey>=u.rkey),e=this.Structure.filter(u=>(u.rkey-u.lkey)%2===0),r=this.Structure.filter(u=>(u.lkey-u.depth+2)%2===1),i=[];return t.length!==0&&i.push({LeftLessRight:t}),e.length!==0&&i.push({ModKeys:e}),r.length!==0&&i.push({Depth:r}),i};this.debug=()=>this.getNodes().map(t=>`${String(" ").repeat(t.depth+1)}> ${JSON.stringify(this.Data[t.itemId])}(itemId:${t.itemId}; nodeId:${t._id}; lkey:${t.lkey}; rkey:${t.rkey}; depth:${t.depth}; childs:${t.childs})`).join(`
`);this.Structure=[],this.Data={}}},g=f;})();
//# sourceMappingURL=nested-set.min.js.map
